SUBSCRIBER_ID:
    .:           {fqdn: '.',           ipv4: '000.000.0.000', msisdn: '0000000000' }
    foo100.rgw.: {fqdn: 'foo100.rgw.', ipv4: '192.168.0.100', msisdn: '0000000100' }
    foo101.rgw.: {fqdn: 'foo101.rgw.', ipv4: '192.168.0.101', msisdn: '0000000101' }

SUBSCRIBER_SERVICES:
    .:
        CIRCULARPOOL:
            - {max: 5 }
        FIREWALL_EXAMPLE:
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'ACCEPT', 'metadata': {'ipt_hashlimit': '-m hashlimit --hashlimit-upto 1/sec --hashlimit-burst 1 --hashlimit-name lan_dns --hashlimit-mode srcip'}, 'comment':'Host DNS limit'}
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'DROP', 'metadata': {'ipt_string': '-m string --algo bm ! --hex-string "|04|nsfw"'}, 'comment':'Forbidden DNS domain'}
            - {'priority': 10, 'direction': 'INGRESS', 'source-ip': '198.18.0.1/32', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'DROP', 'comment':'Deny incoming ICMP'}
            - {'priority': 10, 'direction': 'INGRESS', 'source-ip': '198.18.1.1/32', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'ACCEPT', 'comment':'Allow incoming ICMP'}
            - {'priority': 10, 'direction': 'INGRESS', 'source-ip': '0.0.0.0/0', 'protocol': 1, 'icmp-type':8, 'icmp-code':0, 'action': 'ACCEPT', 'comment':'Allow all incoming ICMP'}
            - {'priority': 10, 'direction': 'EGRESS', 'destination-ip': '0.0.0.0/0', 'protocol': 132, 'action': 'DROP', 'comment':'Deny outgoing SCTP'}
            - {'priority': 10, 'direction': 'EGRESS', 'destination-ip': '0.0.0.0/0', 'protocol': 6, 'destination-port': 22, 'action': 'DROP', 'comment':'Deny outgoing SSH'}

    foo100.rgw.:
        CIRCULARPOOL:
            - {max: 3 }
        SFQDN:
            - {fqdn: 'foo100.rgw.',                                   proxy_required: false}
            - {fqdn: 'iperf.foo100.rgw.', protocol: 6,    port: 5001, proxy_required: false}
            - {fqdn: 'ssh.foo100.rgw.'  , protocol: 6,    port: 22  , proxy_required: false}
            - {fqdn: 'tcp.foo100.rgw.'  , protocol: 6,    port: 0   , proxy_required: false}
            - {fqdn: 'udp.foo100.rgw.'  , protocol: 17,   port: 0   , proxy_required: false}
            - {fqdn: 'p22.foo100.rgw.'  , protocol: 0,    port: 22  , proxy_required: false}
            - {fqdn: 'vnc.foo100.rgw.'  , protocol: 6,    port: 5900, proxy_required: false}
            - {fqdn: 'www.foo100.rgw.'  , protocol: 6,    port: 80  , proxy_required: true }
            - {fqdn: 'sip.foo100.rgw.'  , protocol: 17,   port: 5060, proxy_required: true }
        FIREWALL_ADMIN:
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'ACCEPT', 'metadata': {'ipt_hashlimit': '-m hashlimit --hashlimit-upto 1/sec --hashlimit-burst 1 --hashlimit-name lan_dns --hashlimit-mode srcip'}, 'comment':'Host DNS limit'}
        FIREWALL_PARENTAL:
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'DROP', 'metadata': {'ipt_string': '-m string --algo bm ! --hex-string "|04|nsfw"'}, 'comment':'Forbidden DNS domain'}
        FIREWALL_LEGACY:
            - {'priority': 10,  'direction': 'INGRESS', 'source-ip': '198.18.0.1/32', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'DROP', 'comment':'Deny incoming ICMP'}
            - {'priority': 10,  'direction': 'INGRESS', 'source-ip': '198.18.1.1/32', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'ACCEPT', 'comment':'Allow incoming ICMP'}
            - {'priority': 10,  'direction': 'INGRESS', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'ACCEPT', 'comment':'Deny incoming ICMP'}
            - {'priority': 10,  'direction': 'INGRESS', 'destination-ip': '0.0.0.0/0', 'protocol': 17, 'destination-port': 5900, 'action': 'DROP', 'comment':'Deny incoming VNC over UDP'}
            - {'priority': 10,  'direction': 'INGRESS', 'destination-ip': '0.0.0.0/0', 'protocol': 6,  'destination-port': 5900, 'action': 'DROP', 'comment':'Deny incoming VNC over TCP'}
            - {'priority': 10,  'direction': 'EGRESS',  'destination-ip': '0.0.0.0/0', 'protocol': 6,  'destination-port': 22, 'action': 'ACCEPT', 'comment':'Allow SSH'}
            - {'priority': 255, 'direction': 'EGRESS',  'action': 'ACCEPT', 'comment':'Allow outgoing'}
            - {'priority': 255, 'direction': 'INGRESS', 'action': 'DROP',   'comment':'Drop incoming'}

    foo101.rgw.:
        CIRCULARPOOL:
            - {max: 2 }
        SFQDN:
            - {fqdn: 'foo101.rgw.',                                   proxy_required: false}
            - {fqdn: 'iperf.foo101.rgw.', protocol: 6,    port: 5001, proxy_required: false}
            - {fqdn: 'ssh.foo101.rgw.'  , protocol: 6,    port: 22  , proxy_required: false}
            - {fqdn: 'icmp.foo101.rgw.' , protocol: 1,    port: 0,    proxy_required: false}
            - {fqdn: 'tcp.foo101.rgw.'  , protocol: 6,    port: 0,    proxy_required: false}
            - {fqdn: 'udp.foo101.rgw.'  , protocol: 17,   port: 0,    proxy_required: false}
            - {fqdn: 'www.foo101.rgw.'  , protocol: 6,    port: 80  , proxy_required: true }
            - {fqdn: 'sip.foo101.rgw.'  , protocol: 17,   port: 5060, proxy_required: true }
            
        FIREWALL_ADMIN:
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'ACCEPT', 'metadata': {'ipt_hashlimit': '-m hashlimit --hashlimit-upto 1/sec --hashlimit-burst 1 --hashlimit-name lan_dns --hashlimit-mode srcip'}, 'comment':'Host DNS limit'}
        FIREWALL_PARENTAL:
            - {'priority': 0, 'direction': 'EGRESS', 'protocol': 17, 'destination-port': 53, 'action': 'DROP', 'metadata': {'ipt_string': '-m string --algo bm ! --hex-string "|04|nsfw"'}, 'comment':'Forbidden DNS domain'}
        FIREWALL_LEGACY:
            - {'priority': 10,  'direction': 'INGRESS', 'protocol': 1,  'icmp-type':8, 'icmp-code':0, 'action': 'ACCEPT', 'comment':'Allow incoming ICMP'}
            - {'priority': 10,  'direction': 'INGRESS', 'protocol': 6,  'destination-port': 5001, 'action': 'ACCEPT', 'comment':'Allow incoming iperf'}
            - {'priority': 255, 'direction': 'INGRESS', 'action': 'DROP',   'comment':'Drop incoming'}
            - {'priority': 255, 'direction': 'EGRESS',  'action': 'ACCEPT', 'comment':'Allow outgoing'}
            - {'priority': 5,   'direction': 'ANY',     'protocol': 6,  'destination-port': 22, 'action': 'ACCEPT', 'comment':'Allow all SSH'}
            - {'priority': 6,   'direction': 'INGRESS', 'protocol': 6,  'destination-port': 22, 'action': 'DROP', 'comment':'Deny incoming SSH*'}
            - {'priority': 6,   'direction': 'EGRESS',  'protocol': 6,  'destination-port': 22, 'action': 'DROP', 'comment':'Deny outgoing SSH*'}


